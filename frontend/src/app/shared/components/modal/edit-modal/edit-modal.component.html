<app-base-modal [title]="'Editar produto'" (cancel)="handleCancel()">

  <form [formGroup]="form" class="modal-form">

    <div class="modal-field">
      <label class="modal-label">Nome</label>
      <input class="modal-input" type="text" formControlName="name" placeholder="Nome do produto" />
      <small class="modal-error" *ngIf="name?.errors?.['required']">Nome é obrigatório</small>
      <small class="modal-error" *ngIf="name?.errors?.['minlength']">Mínimo 4 caracteres</small>
      <small class="modal-error" *ngIf="name?.errors?.['maxlength']">Máximo 30 caracteres</small>
    </div>

    <div class="modal-field">
      <label class="modal-label">Barcode</label>
      <input
        class="modal-input"
        type="text"
        formControlName="barcode"
        placeholder="12345678"
        maxlength="8"
        inputmode="numeric"
        (keydown)="onNumberInput($event)"
        (blur)="barcode?.updateValueAndValidity()"
      />
      <small class="modal-error" *ngIf="barcode?.errors?.['pattern'] && (barcode?.dirty || barcode?.touched)">
        O código deve ter exatamente 8 números.
      </small>
      <small class="modal-error" *ngIf="barcode?.errors?.['barcodeExists']">
        Este código de barras já existe!
      </small>
    </div>

    <div class="modal-field">
      <label class="modal-label">Quantidade</label>
      <input
        class="modal-input"
        type="text"
        formControlName="quantity"
        maxlength="6"
        inputmode="numeric"
        (keydown)="onNumberInput($event)"
      />
      <small class="modal-error" *ngIf="quantity?.errors?.['required']">Quantidade obrigatória</small>
      <small class="modal-error" *ngIf="quantity?.errors?.['pattern']">Somente números</small>
    </div>

    <div class="modal-field">
      <label class="modal-label">Preço</label>
      <input
        class="modal-input"
        type="text"
        formControlName="price"
        placeholder="10,50"
        (keydown)="onPriceInput($event)"
      />
      <small class="modal-error" *ngIf="price?.errors?.['required']">Preço obrigatório</small>
      <small class="modal-error" *ngIf="price?.errors?.['pattern']">Formato inválido</small>
    </div>

  </form>

  <div class="modal-footer">
    <button 
      type="button" 
      class="btn btn--primary" 
      [disabled]="form.invalid" 
      (click)="handleSave()">
      Salvar
    </button>
    <button type="button" class="btn btn--secondary" (click)="handleCancel()">
      Cancelar
    </button>
  </div>

</app-base-modal>
