<!-- Modal principal -->
<div class="overlay" *ngIf="!showConfirmModal && !showErrorModal">
  <div class="modal">
    <h2>Venda</h2>

    <input
      placeholder="Buscar produto"
      [(ngModel)]="search"
      (input)="filter()"
    />

    <ul>
      <li *ngFor="let p of filtered">
        {{ p.name }} — R$ {{ p.price | number:'1.2-2' }} — Estoque: {{ p.quantity }}
        <button (click)="add(p)">+</button>
      </li>
    </ul>

    <hr>

    <h3>Carrinho</h3>
    <div *ngFor="let item of cart">
      {{ item.product.name }}
      <input type="number" min="1" [(ngModel)]="item.quantity" (input)="validateQuantity(item); updateTotal()" />
    </div>

    <h2>Total: R$ {{ total | number:'1.2-2' }}</h2>

    <button (click)="finish()">Finalizar</button>
    <button (click)="close.emit()">Cancelar</button>
  </div>
</div>

<!-- Modal de confirmação -->
<div class="overlay" *ngIf="showConfirmModal">
  <app-sale-confirm-modal
    [total]="total"
    (close)="onCloseConfirm()">
  </app-sale-confirm-modal>
</div>

<!-- Modal de erro -->
<div class="overlay error-overlay" *ngIf="showErrorModal">
  <app-error-modal
    [message]="errorMessage"
    (close)="onCloseError()">
  </app-error-modal>
</div>
